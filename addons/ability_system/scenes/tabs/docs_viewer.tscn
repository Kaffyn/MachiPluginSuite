[gd_scene load_steps=3 format=3]

[ext_resource type="Script" path="res://addons/behavior_states/scenes/tabs/docs_viewer.gd" id="1_script"]
[ext_resource type="Theme" path="res://addons/behavior_states/assets/theme.tres" id="1_theme"]

[node name="Grim√≥rio" type="MarginContainer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_top = 10
script = ExtResource("1_script")

[node name="HSplitContainer" type="HSplitContainer" parent="."]
layout_mode = 2
size_flags_vertical = 3
theme = ExtResource("1_theme")
theme_override_constants/separation = 8
split_offset = 200

[node name="FileList" type="ItemList" parent="HSplitContainer"]
layout_mode = 2
size_flags_vertical = 3
theme = ExtResource("1_theme")
theme_override_constants/h_separation = 12
theme_override_constants/v_separation = 6
item_count = 45
item_0/text = "01_Architecture.md"
item_1/text = "01_GodotFundamentals.md"
item_2/text = "01_Introducao.md"
item_3/text = "01_context.md"
item_4/text = "02_GDScript.md"
item_5/text = "02_ResourceOrientedProgramming.md"
item_6/text = "02_Snake_Grid.md"
item_7/text = "02_architecture.md"
item_8/text = "03_GameLoop.md"
item_9/text = "03_Singletons.md"
item_10/text = "03_Snake_Corpo.md"
item_11/text = "03_standards.md"
item_12/text = "04_Input.md"
item_13/text = "04_SceneAndDataManagement.md"
item_14/text = "04_Snake_GameOver.md"
item_15/text = "05_Physics.md"
item_16/text = "05_Snake_Polimento.md"
item_17/text = "05_StateMachines.md"
item_18/text = "06_HashMap.md"
item_19/text = "06_Pong_Arena.md"
item_20/text = "06_ROP.md"
item_21/text = "07_Composition.md"
item_22/text = "07_Inventory.md"
item_23/text = "07_Pong_Bola.md"
item_24/text = "08_Pong_AI_Score.md"
item_25/text = "08_Translations.md"
item_26/text = "08_UI.md"
item_27/text = "09_Debugging.md"
item_28/text = "09_Pong_Polimento.md"
item_29/text = "09_Testing_QA.md"
item_30/text = "10_GameFeel.md"
item_31/text = "10_Internacionaliza√ß√£o.md"
item_32/text = "10_Pacman_Tilemap.md"
item_33/text = "11_Pacman_Coletaveis.md"
item_34/text = "11_Shaders.md"
item_35/text = "12_CharacterSheet.md"
item_36/text = "12_Pacman_IA.md"
item_37/text = "13_Pacman_Powerups.md"
item_38/text = "13_Plugins.md"
item_39/text = "14_GDExtensions.md"
item_40/text = "15_RustAIExtension.md"
item_41/text = "EMENTA.md"
item_42/text = "GEMINI.md"
item_43/text = "Luna.md"
item_44/text = "README.md"

[node name="ScrollContainer" type="ScrollContainer" parent="HSplitContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="MarginContainer" type="MarginContainer" parent="HSplitContainer/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/margin_left = 15
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 15
theme_override_constants/margin_bottom = 10

[node name="ContentLabel" type="RichTextLabel" parent="HSplitContainer/ScrollContainer/MarginContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme = ExtResource("1_theme")
bbcode_enabled = true
text = "[font_size=32][b]BehaviorStates: A Next-Gen Behavior Architecture for Godot[/b][/font_size]

[color=#888888][i]  [b]Vis√£o:[/b] Prover um Framework de Comportamento n√≠vel AAA, orientado a dados, que rivalize com os padr√µes da ind√∫stria (como o GAS da Unreal), permitindo que Designers e Programadores construam sistemas reativos complexos sem acoplamento de c√≥digo.[/i][/color]
>
[color=#888888][i]  [b]Filosofia:[/b] \"Query, Don't Transition\". Em vez de hardcodar transi√ß√µes, o sistema avalia o [b]Contexto[/b] atual e escolhe o melhor [b]BehaviorUnit[/b] para aquele momento via Indexa√ß√£o O(1).[/i][/color]

---

[font_size=24][b]üèõÔ∏è Os Pilares da Arquitetura[/b][/font_size]

O sistema inverte a l√≥gica tradicional de State Machines. Em vez de hardcodar transi√ß√µes, usamos [b]Query de Dados[/b].

- [b]O C√©rebro ([code]Behavior.gd[/code]):[/b] O orquestrador de inten√ß√£o. Faz a ponte entre o Input Bruto e o Contexto Sem√¢ntico.
- [b]A Engine ([code]Machine.gd[/code]):[/b] O Executor e Interpretador (VM). L√™ os dados do Resource e executa fun√ß√µes especializadas ([code]apply_jump[/code], [code]spawn_projectile[/code]) para materializar o gameplay.
- [b]O DNA ([code]Resources[/code]):[/b] Comportamento √© Dado. Mut√°vel, troc√°vel e extens√≠vel sem recompila√ß√£o.
- [b]A Bancada ([code]Workbench[/code]):[/b] Uma IDE totalmente integrada dentro da Godot. Visual, intuitiva e livre de c√≥digo.

---

[font_size=24][b]üåü Filosofia: \"Query, Don't Transition\"[/b][/font_size]

Em uma FSM tradicional, voc√™ define [b]Transi√ß√µes[/b]:

[color=#888888][i]  _\"Se estou andando e aperto Shift, vou para Correr.\"_[/i][/color]

No BehaviorStates, voc√™ define [b]Requisitos[/b]:

[color=#888888][i]  _\"O estado Correr requer que o input 'Run' esteja ativo.\"_[/i][/color]

A [b]Machine[/b] (C√©rebro) olha para o Contexto atual (Inputs, F√≠sica, Status, Arma, Item) e faz uma \"Query\" no banco de dados ([code]Manifest[/code]) dispon√≠vel para encontrar o [b]Best Match[/b].

[font_size=20][b]Vantagens[/b][/font_size]

- [b]Desacoplamento Total:[/b] Estados n√£o sabem da exist√™ncia uns dos outros.
- [b]Escalabilidade:[/b] Adicione 50 ataques novos apenas criando arquivos [code].tres[/code].
- [b]Hot-Swapping:[/b] Troque o \"Deck\" de habilidades (ex: trocar de arma) em tempo real.
- [b]Performance O(1):[/b] Indexa√ß√£o invertida garante custo fixo de busca.

---

[font_size=24][b]üöÄ O Roadmap para o Nativo (Vision)[/b][/font_size]

1. [b]Fase 1 (GDScript Plugin):[/b] Foco do [b]M√≥dulo 10[/b] do curso. Prototipagem r√°pida e ado√ß√£o pela comunidade. O foco √© a DX (Developer Experience) e a estabilidade da API.
2. [b]Fase 2 (Rust GDExtension):[/b] Reescrever o _Core_ (Machine e Algoritmos de Busca) em Rust para performance de n√≠vel bare-metal, mantendo a API GDScript id√™ntica.
3. [b]Fase 3 (Godot Native):[/b] Propor o framework como um m√≥dulo oficial da engine (C++), preenchendo a lacuna hist√≥rica de uma State Machine visual nativa na Godot.

---

[font_size=24][b]1. A Bancada (Editor Integration)[/b][/font_size]

O Painel [code]BehaviorStates[/code] transforma o editor em um workspace poderoso.

- [b]A Asset Library:[/b] Um reposit√≥rio inteligente que indexa todo Recurso de Comportamento no projeto. Suporta tags de metadados (\"Agressivo\", \"M√°gico\") e filtros instant√¢neos.
- [b]O Behavior Graph:[/b] Um ambiente de script visual baseado em n√≥s para definir:
  - [b]Cadeias de Transi√ß√£o:[/b] Linkar visualmente [code]Ataque_A[/code] para [code]Ataque_B[/code] com arestas condicionais.
  - [b]L√≥gica de Interrup√ß√£o:[/b] Definir overrides de prioridade visualmente.
- [b]A Factory:[/b] Um wizard baseado em templates que gera c√≥digo boilerplate e resources, for√ßando consist√™ncia arquitetural automaticamente.
- [b]O Live Debugger:[/b] Ferramentas de an√°lise em runtime:
  - [b]Viagem no Tempo:[/b] Gravar e navegar pelos √∫ltimos 60 segundos de decis√µes.
  - [b]Heatmap:[/b] Visualizar frequ√™ncia de estados.
  - [b]Live Sync:[/b] O grafo destaca o n√≥ ativo em tempo real.

---

[font_size=24][b]2. API de Dados (The DNA)[/b][/font_size]

Scripts que estendem [code]Resource[/code]. S√£o a \"Mem√≥ria\" do sistema. A estrutura abaixo detalha as propriedades principais de cada classe.

[font_size=20][b]2.1. [code]BehaviorUnit[/code] (State.gd)[/b][/font_size]

A unidade at√¥mica de comportamento. Define \"O que acontece\" e \"Quando acontece\".

#### Propriedades Exportadas

[b]Core Identity & Visuals[/b]

- [code]name: String[/code]
- [code]texture: Texture2D[/code]
- [code]animation_res: Animation[/code]
- [code]loop: bool[/code]
- [code]debug_color: Color[/code]

[b]Logica de Filtro (Context-Aware)[/b]
Define os [b]Requisitos de Entrada[/b] via um Dicion√°rio de Tags.

[code]@export var requirements: Dictionary = {
    \"motion\": BehaviorStates.Motion.ANY,
    \"weapon\": BehaviorStates.Weapon.KATANA,
    \"physics\": BehaviorStates.Physics.GROUND
}
[/code]

[b]F√≠sica e Movimento[/b]

- [code]speed_multiplier: float[/code]: Multiplica a velocidade base do CharacterSheet.
- [code]jump_force: float[/code]: For√ßa de impulso vertical.
- [code]friction: float[/code]: Controle de parada.
- [code]lock_movement: bool[/code]: Impede input de movimento durante o estado.
- [code]ignore_gravity: bool[/code]: √ötil para dashes a√©reos ou skills de voo.

[b]Combate (Melee & Ranged)[/b]

- [code]damage: int[/code]: Valor base de dano.
- [code]cooldown: float[/code]: Tempo antes de poder reentrar neste contexto.
- [code]projectile_scene: PackedScene[/code]: Cena instanciada para ataques √† dist√¢ncia.
- [code]projectile_speed: float[/code]
- [code]spawn_offset: Vector2[/code]

[b]Ciclo de Vida (Hooks)[/b]

- [code]Enter()[/code]: Aplica modificadores, toca anima√ß√£o.
- [code]Exit()[/code]: Limpa modificadores.
- [code]Update(delta)[/code]: L√≥gica frame a frame.
- [code]PhysicsUpdate(delta)[/code]: L√≥gica de f√≠sica (ex: Homing Missile).

[font_size=20][b]2.2. [code]Compose[/code] (Compose.gd)[/b][/font_size]

O \"Deck\" de estados. Respons√°vel por agrupar e indexar os estados.

- [b]Storage:[/b] Mant√©m arrays de States ([code]move_states[/code], [code]attack_states[/code], [code]interactive_states[/code]).
- [b]Indexa√ß√£o ([code]@tool[/code]):[/b] Constr√≥i os HashMaps ([code]move_rules[/code], [code]attack_rules[/code]) em tempo de edi√ß√£o.
- [b]Heran√ßa:[/b] Suporta empilhamento de Manifestos.

[font_size=20][b]2.3. Containers Sem√¢nticos[/b][/font_size]

#### [code]ItemData[/code] e [code]WeaponData[/code]

Wrappers que carregam um Compose.

- [code]display_name: String[/code]
- [code]icon: Texture2D[/code]
- [code]compose: Compose[/code]: O comportamento conferido ao equipar.
- [code]context_modifiers: Dictionary[/code]: Tags passivas (ex: [code]Weapon: KATANA[/code]) que este item ativa no Contexto Global.

#### [code]CharacterSheet[/code]

A \"Ficha\" de RPG.

- [code]max_health[/code], [code]max_stamina[/code]
- [code]base_speed[/code], [code]base_jump_force[/code]
- [code]attributes: Dictionary[/code] (ex: For√ßa, Agilidade).

---

[font_size=24][b]3. Componentes de Runtime (The Nodes)[/b][/font_size]

[font_size=20][b]3.1. [code]Behavior.gd[/code] (O C√©rebro)[/b][/font_size]

O n√≥ de processamento de inten√ß√£o. Fica na raiz do personagem.

- [b]Responsabilidade:[/b] Traduzir [code]Input[/code] -> [code]Contexto[/code].
- [b]Input Buffering:[/b] Implementa Coyote Time e Queue de A√ß√µes.
- [b]Orquestra√ß√£o:[/b] Controla a [code]Machine[/code] e o [code]Inventory[/code].
- [b]C√≥digo Exemplo:[/b]

  [code]  func _physics_process(delta):
      # Traduz Input para Contexto
      if Input.is_action_pressed(\"run\"):
          machine.set_context(\"Motion\", BehaviorStates.Motion.RUN)

      # Gerencia Gravidade e Movimento F√≠sico
      _handle_physics()
  [/code]

[font_size=20][b]3.2. [code]Machine.gd[/code] (A Engine VM)[/b][/font_size]

O processador de decis√£o puro. N√£o sabe o que √© um \"Player\" ou \"Input\".

- [b]Query Engine:[/b] Executa a busca O(1).
- [b]Interpretador:[/b] Funciona como uma VM com instru√ß√µes especializadas:
  - [code]apply_velocity(Vector2)[/code]
  - [code]spawn_projectile(PackedScene)[/code]
  - [code]play_animation(String)[/code]
- [b]Event Bus:[/b] [code]signal state_changed(old, new)[/code]

[font_size=20][b]3.3. [code]Inventory.gd[/code] (Gerenciador de Equipamento)[/b][/font_size]

- Gerencia slots de itens e equipa/desequipa.
- Notifica a Machine para trocar o Manifesto ativo em O(1).
- [b]Fallback Logic:[/b] Se voc√™ tenta atacar com uma Potion e ela n√£o tem estado de ataque, o Inventory fornece o Manifesto \"Unharmed\" (Desarmado) para garantir que um soco saia.

---

[font_size=24][b]4. O Algoritmo (Reverse Query Hash Map)[/b][/font_size]

[color=#888888][i]  [b]Status:[/b] Implementado | [b]Deep Dive T√©cnico[/b][/i][/color]

N√≥s rejeitamos itera√ß√£o O(N). O sistema usa uma [b]Estrat√©gia de Indexa√ß√£o Reversa[/b] para garantir sele√ß√£o em tempo constante ([code]O(1)[/code]).

[font_size=20][b]4.1. Estrutura de Indexa√ß√£o (Index Time)[/b][/font_size]

O script [code]Compose.gd[/code] roda como [code]@tool[/code]. Sempre que voc√™ salva um recurso [code].tres[/code], ele reconstr√≥i os √≠ndices:

[code]# Compose.gd
@export var move_rules : Dictionary = {}   # { Motion.RUN: [RunState, ...], ... }
@export var attack_rules : Dictionary = {} # { Attack.FAST: [Slash1, ...], ... }
[/code]

Cada estado define sua chave de indexa√ß√£o via [code]get_lookup_key()[/code].

- [b]Exce√ß√µes:[/b] Filtros negativos (ex: [code]EXCEPT_DASH[/code]) s√£o indexados no bucket gen√©rico ([code]ANY[/code]) para serem testados sempre.

[font_size=20][b]4.2. O Fluxo de Query (Runtime)[/b][/font_size]

Quando a Machine precisa decidir o pr√≥ximo frame:

1. [b]Chaveamento:[/b] A Machine constr√≥i uma chave a partir do Contexto atual (ex: [code]Motion.RUN[/code]).
2. [b]Lookup Direto (O(1)):[/b]
   [code]   # Machine.gd
   var candidates = current_manifest.move_rules.get(current_motion_context, [])
   # Adiciona candidatos gen√©ricos (ANY)
   candidates.append_array(current_manifest.move_rules.get(0, []))
   [/code]
3. [b]Resultado:[/b] Em vez de iterar 500 estados, iteramos apenas os 2 ou 3 que fazem sentido naquele microssegundo.

[font_size=20][b]4.3. Fuzzy Scoring (Desempate)[/b][/font_size]

Com a lista de candidatos reduzida, aplicamos um sistema de pontua√ß√£o para escolher o vencedor:

1. [b]Filtro R√≠gido:[/b] Requisitos booleanos (ex: [code]Physics: GROUND[/code]) eliminam candidatos incompat√≠veis imediatamente.
2. [b]Pontua√ß√£o de Especificidade:[/b]
   - Match Exato de Atributo (ex: [code]Weapon: KATANA[/code] quando equipada): [b]+10 Pontos[/b].
   - Match Gen√©rico ([code]Weapon: ANY[/code]): [b]+0 Pontos[/b].
   - Prioridade de Chain (Combo): [b]+20 Pontos[/b].

Isso garante que um \"Ataque Gen√©rico\" seja substitu√≠do automaticamente por uma \"Cutilada de Katana\" quando a arma √© equipada, sem nenhum [code]if/else[/code] no c√≥digo.

---

[font_size=24][b]5. Refer√™ncia T√©cnica (Vocabul√°rio Global)[/b][/font_size]

Definido em [code]BehaviorStates.gd[/code] (Autoload). Serve como a \"Verdade √önica\" para tipos no projeto inteiro.

| Categoria    | Valores                             | Descri√ß√£o                                  |
| :----------- | :---------------------------------- | :----------------------------------------- |
| [b]Motion[/b]   | [code]IDLE[/code], [code]WALK[/code], [code]RUN[/code], [code]DASH[/code]       | Estados de locomo√ß√£o terrestre             |
| [b]Physics[/b]  | [code]GROUND[/code], [code]AIR[/code], [code]WATER[/code]            | Estado f√≠sico do corpo no mundo            |
| [b]Attack[/b]   | [code]NONE[/code], [code]FAST[/code], [code]NORMAL[/code], [code]CHARGED[/code] | Inten√ß√£o de combate                        |
| [b]Weapon[/b]   | [code]KATANA[/code], [code]BOW[/code], [code]NONE[/code]             | Tipo de equipamento ativo                  |
| [b]Reaction[/b] | [code]CANCEL[/code], [code]ADAPT[/code], [code]FINISH[/code]         | Como reagir a mudan√ßas bruscas de contexto |
| [b]Status[/b]   | [code]NORMAL[/code], [code]STUNNED[/code], [code]DEAD[/code]         | Condi√ß√µes de status do personagem          |

---

[color=#888888][i]  _BehaviorStates Framework - Documenta√ß√£o T√©cnica Unificada._[/i][/color]
"
fit_content = true
scroll_active = false
scroll_following = true
scroll_following_visible_characters = true
